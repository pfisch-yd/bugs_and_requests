With Dataframe:
DataFrame[udf_name: string, column: string, status: string]
[2025-09-15 18:44:41] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_schema_check' ..
[2025-09-15 18:44:46] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2670537s to 2676464s.
[2025-09-15 18:44:46] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2676464, log_retention_days=3650, minimum_versions=1
[2025-09-15 18:44:46] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_schema_check have changed. Updating retention settings...
[2025-09-15 18:44:46] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_schema_check' table properties `delta.deletedFileRetentionDuration` to 'interval 2676464 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 18:44:50] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_schema_check!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_schema_check"
Succesfully exported Schema Check.
prep_filter_items
âœ… Validated variant column: 'product_attributes'
ðŸ”§ Processing table with 1 variant column(s): ['product_attributes']
ðŸ”§ Preprocessing DataFrame to handle NULL columns...
âœ… Table ydx_prospect_analysts_sandbox.beauty_product_v38_filter_items_before exists with variant support. Writing data directly...
With Dataframe:
DataFrame[row_id: string, item_key: string, zip_prefix: int, order_id: string, order_date: date, day: date, week: date, month: date, year: date, channel: string, user_id: string, item_id: string, item_id_v2: string, item_id_org: string, mapped_brand: string, sub_cat_1: string, sub_cat_2: string, sub_cat_3: string, sub_cat_4: string, sub_cat_5: string, uct_cat_1: string, uct_cat_2: string, uct_cat_3: string, uct_cat_4: string, uct_cat_5: string, uct_cat_6: string, uct_cat_7: string, product_description: string, web_description: string, msa: string, state: string, household_income: string, sku: string, seller: string, delivery_method: string, source: string, zip: string, upc: string, model_num: string, match_type: string, item_fidelity: string, outlier_flag: string, seller_name: string, reported_category_name: string, item_quantity: double, item_price: double, full_price_estimate: double, gmv_unadj: double, factor_cat: float, factor_age: float, yd_adj_gmv: double, pro_adj_gmv: double, cohort_date: date, panel_start_date: date, panel_end_date: date, age_attribute: string, gender_attribute: string, age: string, gender: string, region: string, division: string, ld: string, walmart_web_cat_1: string, walmart_web_cat_2: string, walmart_web_cat_3: string, walmart_web_cat_4: string, walmart_web_cat_5: string, join_key: string, brand_original: string, leia_panel_flag_source: int, color: string, size: string, parent_sku: string, parent_sku_name: string, variation_sku: string, variation_sku_name: string, private_label_flag: boolean, factor_gender: float, factor_geo: float, is_autoship: string, fragrance_family: string, scent_type: string, key_notes: string, formulation: string, coverage: string, finish: string, highlights: string, subscribe_and_save: int, product_attributes: variant, product_url: string, best_description: string, merchant_partition: string, final_cat_1: string, sandbox_factor_cat: double, sandbox_factor_gender: double, sandbox_factor_geo: double, multiplier: double, gmv_adj_merchant: double, mapped_brand_beauty: string, summary: string, details: string, how_to_use: string, ingredients: string, merchant: string, brand: string, final_cat_2: string, final_cat_3: string, gmv: double, merchant_clean: string, sub_brand: string, parent_brand: string, major_cat: string, sub_cat: string, minor_cat: string, leia_panel_flag: int, product_hash: string]
[2025-09-15 18:46:18] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_filter_items_before' ..
[2025-09-15 18:53:15] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 418s to 2675863s.
[2025-09-15 18:53:15] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2675863, log_retention_days=3650, minimum_versions=1
[2025-09-15 18:53:15] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_filter_items_before have changed. Updating retention settings...
[2025-09-15 18:53:15] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_filter_items_before' table properties `delta.deletedFileRetentionDuration` to 'interval 2675863 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 18:53:27] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_filter_items_before!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_filter_items_before"
âœ… Validated variant column: 'product_attributes'
ðŸ”§ Processing table with 1 variant column(s): ['product_attributes']
ðŸ”§ Preprocessing DataFrame to handle NULL columns...
âœ… Table ydx_prospect_analysts_sandbox.beauty_product_v38_filter_items exists with variant support. Writing data directly...
With Dataframe:
DataFrame[row_id: string, item_key: string, zip_prefix: int, order_id: string, order_date: date, day: date, week: date, month: date, year: date, channel: string, user_id: string, item_id: string, item_id_v2: string, item_id_org: string, mapped_brand: string, sub_cat_1: string, sub_cat_2: string, sub_cat_3: string, sub_cat_4: string, sub_cat_5: string, uct_cat_1: string, uct_cat_2: string, uct_cat_3: string, uct_cat_4: string, uct_cat_5: string, uct_cat_6: string, uct_cat_7: string, product_description: string, web_description: string, msa: string, state: string, household_income: string, sku: string, seller: string, delivery_method: string, source: string, zip: string, upc: string, model_num: string, match_type: string, item_fidelity: string, outlier_flag: string, seller_name: string, reported_category_name: string, item_quantity: double, item_price: double, full_price_estimate: double, gmv_unadj: double, factor_cat: float, factor_age: float, yd_adj_gmv: double, pro_adj_gmv: double, cohort_date: date, panel_start_date: date, panel_end_date: date, age_attribute: string, gender_attribute: string, age: string, gender: string, region: string, division: string, ld: string, walmart_web_cat_1: string, walmart_web_cat_2: string, walmart_web_cat_3: string, walmart_web_cat_4: string, walmart_web_cat_5: string, join_key: string, brand_original: string, leia_panel_flag_source: int, color: string, size: string, parent_sku: string, parent_sku_name: string, variation_sku: string, variation_sku_name: string, private_label_flag: boolean, factor_gender: float, factor_geo: float, is_autoship: string, fragrance_family: string, scent_type: string, key_notes: string, formulation: string, coverage: string, finish: string, highlights: string, subscribe_and_save: int, product_attributes: variant, product_url: string, best_description: string, merchant_partition: string, final_cat_1: string, sandbox_factor_cat: double, sandbox_factor_gender: double, sandbox_factor_geo: double, multiplier: double, gmv_adj_merchant: double, mapped_brand_beauty: string, summary: string, details: string, how_to_use: string, ingredients: string, merchant: string, brand: string, final_cat_2: string, final_cat_3: string, gmv: double, merchant_clean: string, sub_brand: string, parent_brand: string, major_cat: string, sub_cat: string, minor_cat: string, leia_panel_flag: int, product_hash: string, special_attribute_column: string, special_attribute_display: string]
[2025-09-15 18:54:53] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_filter_items' ..
[2025-09-15 18:58:11] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 381s to 2675120s.
[2025-09-15 18:58:11] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2675120, log_retention_days=3650, minimum_versions=1
[2025-09-15 18:58:11] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_filter_items have changed. Updating retention settings...
[2025-09-15 18:58:11] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_filter_items' table properties `delta.deletedFileRetentionDuration` to 'interval 2675120 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 18:58:19] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_filter_items!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_sandbox.beauty_product_v38_filter_items"
run_export_client_specs
With Dataframe:
DataFrame[display_brands: string, parent_brand: string, dash_display_title: string, client_email_distro: string]
[2025-09-15 18:58:28] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_client_specs' ..
[2025-09-15 18:58:34] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2670625s to 2675116s.
[2025-09-15 18:58:34] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2675116, log_retention_days=3650, minimum_versions=1
[2025-09-15 18:58:34] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_client_specs have changed. Updating retention settings...
[2025-09-15 18:58:34] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_client_specs' table properties `delta.deletedFileRetentionDuration` to 'interval 2675116 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 18:58:41] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_client_specs!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_client_specs"
With Dataframe:
DataFrame[category: string, level: string, source: string, users: bigint, active_users: bigint]
[2025-09-15 18:58:49] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_panel_stats' ..
[2025-09-15 18:59:23] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2670461s to 2675119s.
[2025-09-15 18:59:23] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2675119, log_retention_days=3650, minimum_versions=1
[2025-09-15 18:59:23] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_panel_stats have changed. Updating retention settings...
[2025-09-15 18:59:23] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_panel_stats' table properties `delta.deletedFileRetentionDuration` to 'interval 2675119 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 18:59:28] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_panel_stats!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_panel_stats"
With Dataframe:
DataFrame[ssg: decimal(3,1)]
[2025-09-15 18:59:36] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sample_size_guardrail' ..
[2025-09-15 18:59:44] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2670428s to 2675120s.
[2025-09-15 18:59:44] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2675120, log_retention_days=3650, minimum_versions=1
[2025-09-15 18:59:44] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sample_size_guardrail have changed. Updating retention settings...
[2025-09-15 18:59:44] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sample_size_guardrail' table properties `delta.deletedFileRetentionDuration` to 'interval 2675120 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 18:59:48] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sample_size_guardrail!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sample_size_guardrail"

Succesfully exported client_specs.
run_export_shopper_insights_module
âœ… Validated variant column: 'product_attributes'
ðŸ”§ Processing table with 1 variant column(s): ['product_attributes']
ðŸ”§ Preprocessing DataFrame to handle NULL columns...
âœ… Table ydx_prospect_analysts_gold.beauty_product_v38_filter_items exists with variant support. Writing data directly...
With Dataframe:
DataFrame[row_id: string, item_key: string, zip_prefix: int, order_id: string, order_date: date, day: date, week: date, month: date, year: date, channel: string, user_id: string, item_id: string, item_id_v2: string, item_id_org: string, mapped_brand: string, sub_cat_1: string, sub_cat_2: string, sub_cat_3: string, sub_cat_4: string, sub_cat_5: string, uct_cat_1: string, uct_cat_2: string, uct_cat_3: string, uct_cat_4: string, uct_cat_5: string, uct_cat_6: string, uct_cat_7: string, product_description: string, web_description: string, msa: string, state: string, household_income: string, sku: string, seller: string, delivery_method: string, source: string, zip: string, upc: string, model_num: string, match_type: string, item_fidelity: string, outlier_flag: string, seller_name: string, reported_category_name: string, item_quantity: double, item_price: double, full_price_estimate: double, gmv_unadj: double, factor_cat: float, factor_age: float, yd_adj_gmv: double, pro_adj_gmv: double, cohort_date: date, panel_start_date: date, panel_end_date: date, age_attribute: string, gender_attribute: string, age: string, gender: string, region: string, division: string, ld: string, walmart_web_cat_1: string, walmart_web_cat_2: string, walmart_web_cat_3: string, walmart_web_cat_4: string, walmart_web_cat_5: string, join_key: string, brand_original: string, leia_panel_flag_source: int, color: string, size: string, parent_sku: string, parent_sku_name: string, variation_sku: string, variation_sku_name: string, private_label_flag: boolean, factor_gender: float, factor_geo: float, is_autoship: string, fragrance_family: string, scent_type: string, key_notes: string, formulation: string, coverage: string, finish: string, highlights: string, subscribe_and_save: int, product_attributes: variant, product_url: string, best_description: string, merchant_partition: string, final_cat_1: string, sandbox_factor_cat: double, sandbox_factor_gender: double, sandbox_factor_geo: double, multiplier: double, gmv_adj_merchant: double, mapped_brand_beauty: string, summary: string, details: string, how_to_use: string, ingredients: string, merchant: string, brand: string, final_cat_2: string, final_cat_3: string, gmv: double, merchant_clean: string, sub_brand: string, parent_brand: string, major_cat: string, sub_cat: string, minor_cat: string, leia_panel_flag: int, product_hash: string, special_attribute_column: string, special_attribute_display: string, leia_panel_flag_test: int, annual_active_users: bigint, rolling_active_users: bigint, age_cohort: string, age_adj_2yr: double, age_adj_annual: double]
[2025-09-15 19:01:45] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_filter_items' ..
[2025-09-15 19:09:02] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 649s to 2674047s.
[2025-09-15 19:09:02] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674047, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:09:02] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_filter_items have changed. Updating retention settings...
[2025-09-15 19:09:02] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_filter_items' table properties `delta.deletedFileRetentionDuration` to 'interval 2674047 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:09:17] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_filter_items!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_filter_items"

Succesfully exported Shopper Insights module.
run_export_market_share_module
With Dataframe:
DataFrame[display_interval: string]
[2025-09-15 19:09:26] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_display_interval_monthly' ..
[2025-09-15 19:09:32] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 1045035s to 1628546s.
[2025-09-15 19:09:32] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=1628546, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:09:32] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_display_interval_monthly have changed. Updating retention settings...
[2025-09-15 19:09:32] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_display_interval_monthly' table properties `delta.deletedFileRetentionDuration` to 'interval 1628546 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:09:37] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_display_interval_monthly!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_display_interval_monthly"
With Dataframe:
DataFrame[date: date, month_start: date, month_end: date, month: int, quarter_start: date, quarter_end: date, quarter: int, year_start: date, year_end: date, year: int, max_month: int, max_quarter: int, max_date: date, parent_brand: string, brand: string, sub_brand: string, major_category: string, sub_category: string, minor_category: string, merchant: string, channel: string, special_attribute: string, gmv: decimal(36,8), units: decimal(36,8), sample_size: int, item_subtotal_observed: int, item_quantity_observed: int, gmv_trailing_3m: decimal(36,8), gmv_trailing_6m: decimal(36,8), gmv_trailing_12m: decimal(36,8), units_trailing_3m: decimal(36,8), units_trailing_6m: decimal(36,8), units_trailing_12m: decimal(36,8), sample_size_trailing_3m: int, sample_size_trailing_6m: int, sample_size_trailing_12m: int, _updated_timestamp: timestamp]
[2025-09-15 19:09:59] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null_standard_calendar' ..
[2025-09-15 19:15:09] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 1045536s to 1628630s.
[2025-09-15 19:15:09] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=1628630, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:15:09] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null_standard_calendar have changed. Updating retention settings...
[2025-09-15 19:15:09] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null_standard_calendar' table properties `delta.deletedFileRetentionDuration` to 'interval 1628630 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:15:16] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null_standard_calendar!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null_standard_calendar"
With Dataframe:
DataFrame[date: date, month_start: date, month_end: date, month: int, quarter_start: date, quarter_end: date, quarter: bigint, year_start: date, year_end: date, year: string, max_month: int, max_quarter: bigint, max_date: date, parent_brand: string, brand: string, sub_brand: string, major_category: string, sub_category: string, minor_category: string, merchant: string, channel: string, special_attribute: string, gmv: decimal(36,8), units: decimal(36,8), sample_size: int, item_subtotal_observed: int, item_quantity_observed: int, gmv_trailing_3m: decimal(36,8), gmv_trailing_6m: decimal(36,8), gmv_trailing_12m: decimal(36,8), units_trailing_3m: decimal(36,8), units_trailing_6m: decimal(36,8), units_trailing_12m: decimal(36,8), sample_size_trailing_3m: int, sample_size_trailing_6m: int, sample_size_trailing_12m: int, _updated_timestamp: timestamp]
[2025-09-15 19:15:48] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null_nrf_calendar' ..
[2025-09-15 19:20:15] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 1045578s to 1628673s.
[2025-09-15 19:20:15] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=1628673, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:20:15] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null_nrf_calendar have changed. Updating retention settings...
[2025-09-15 19:20:15] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null_nrf_calendar' table properties `delta.deletedFileRetentionDuration` to 'interval 1628673 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:20:24] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null_nrf_calendar!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null_nrf_calendar"
With Dataframe:
DataFrame[display_interval: string]
[2025-09-15 19:20:36] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_display_interval_monthly' ..
[2025-09-15 19:20:45] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 1628546s to 663s.
[2025-09-15 19:20:45] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=663, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:20:45] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_display_interval_monthly have changed. Updating retention settings...
[2025-09-15 19:20:45] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_display_interval_monthly' table properties `delta.deletedFileRetentionDuration` to 'interval 663 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:20:53] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_display_interval_monthly!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_display_interval_monthly"
With Dataframe:
DataFrame[trunc_day: date, channel: string, parent_brand: string, brand: string, sub_brand: string, merchant: string, major_cat: string, sub_cat: string, minor_cat: string, special_attribute: string, gmv: double, sample_size: bigint, item_subtotal_observed: double, item_quantity_observed: double]
[2025-09-15 19:21:16] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null' ..
[2025-09-15 19:24:21] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 102s to 2674243s.
[2025-09-15 19:24:21] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674243, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:24:21] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null have changed. Updating retention settings...
[2025-09-15 19:24:21] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null' table properties `delta.deletedFileRetentionDuration` to 'interval 2674243 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:24:30] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null"
With Dataframe:
DataFrame[trunc_day: date, channel: string, parent_brand: string, brand: string, sub_brand: string, merchant: string, major_cat: string, sub_cat: string, minor_cat: string, special_attribute: string, gmv: double, sample_size: bigint, item_subtotal_observed: double, item_quantity_observed: double]
[2025-09-15 19:24:40] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null' ..
[2025-09-15 19:26:58] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2674243s to 158s.
[2025-09-15 19:26:58] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=158, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:26:58] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null have changed. Updating retention settings...
[2025-09-15 19:26:59] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null' table properties `delta.deletedFileRetentionDuration` to 'interval 158 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:27:04] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_market_share_for_column_null"

Succesfully exported Market Share module.
run_export_geo_analysis_module
With Dataframe:
DataFrame[state: string, month: date, parent_brand: string, brand: string, sub_brand: string, merchant: string, major_cat: string, sub_cat: string, minor_cat: string, gmv: double, sample_size: bigint, observed_spend: double, observed_units: double]
[2025-09-15 19:27:14] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_geographic_analysis' ..
[2025-09-15 19:27:44] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2670587s to 2674409s.
[2025-09-15 19:27:44] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674409, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:27:44] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_geographic_analysis have changed. Updating retention settings...
[2025-09-15 19:27:44] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_geographic_analysis' table properties `delta.deletedFileRetentionDuration` to 'interval 2674409 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:27:50] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_geographic_analysis!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_geographic_analysis"

Succesfully exported Geo Analysis module.
run_export_product_analysis_module
âœ… Validated variant column: 'product_attributes'
ðŸ”§ Processing table with 1 variant column(s): ['product_attributes']
ðŸ”§ Preprocessing DataFrame to handle NULL columns...
âœ… Table ydx_prospect_analysts_gold.beauty_product_v38_sku_analysis exists with variant support. Writing data directly...
With Dataframe:
DataFrame[product_id_type: string, display_interval: string, channel: string, max_date: timestamp, major_cat: string, sub_cat: string, minor_cat: string, web_description: string, merchant: string, brand: string, sub_brand: string, period_starting: timestamp, product_id: string, product_hash: string, parent_sku: string, parent_sku_name: string, variation_sku: string, variation_sku_name: string, parent_brand: string, product_url: string, total_spend: double, total_units: double, gmv: double, observations: bigint, last_obs: bigint, last_gmv: double, new_sku_flag: int, product_attributes: variant]
[2025-09-15 19:28:09] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_analysis' ..
[2025-09-15 19:34:02] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 86s to 2674531s.
[2025-09-15 19:34:02] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674531, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:34:02] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_analysis have changed. Updating retention settings...
[2025-09-15 19:34:02] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_analysis' table properties `delta.deletedFileRetentionDuration` to 'interval 2674531 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:34:27] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_analysis!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_analysis"
âœ… Validated variant column: 'product_attributes'
ðŸ”§ Processing table with 1 variant column(s): ['product_attributes']
ðŸ”§ Preprocessing DataFrame to handle NULL columns...
âœ… Table ydx_prospect_analysts_gold.beauty_product_v38_sku_time_series exists with variant support. Writing data directly...
With Dataframe:
DataFrame[product_id_type: string, display_interval: string, channel: string, major_cat: string, sub_cat: string, minor_cat: string, web_description: string, merchant: string, brand: string, sub_brand: string, product_id: string, product_hash: string, parent_sku: string, parent_sku_name: string, variation_sku: string, variation_sku_name: string, parent_brand: string, product_url: string, period_month: date, period_starting: date, max_date: date, total_spend: double, total_units: double, gmv: double, observations: bigint, first_observation_in_month: date, last_observation_in_month: date, last_obs: bigint, last_gmv: double, new_sku_flag: int, product_attributes: variant]
[2025-09-15 19:34:59] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_time_series' ..
[2025-09-15 19:37:13] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 89s to 2264972s.
[2025-09-15 19:37:13] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2264972, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:37:13] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_time_series have changed. Updating retention settings...
[2025-09-15 19:37:14] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_time_series' table properties `delta.deletedFileRetentionDuration` to 'interval 2264972 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:37:19] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_time_series!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_time_series"
With Dataframe:
DataFrame[web_description: string, merchant: string, brand: string, month: date, channel: string, product_id: string, product_hash: string, total_spend: double, total_units: double, gmv: double, observations: bigint, ASP: double, first_observation: date, max_price: double, min_price: double, avg_observations: double]
[2025-09-15 19:37:29] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_detail' ..
[2025-09-15 19:37:59] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2670664s to 2674515s.
[2025-09-15 19:37:59] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674515, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:37:59] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_detail have changed. Updating retention settings...
[2025-09-15 19:38:00] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_detail' table properties `delta.deletedFileRetentionDuration` to 'interval 2674515 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:38:12] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_detail!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_sku_detail"

Succesfully exported Product Analysis module.


run tariffs
With Dataframe:
DataFrame[product_hash: string, merchant: string, brand: string, minor_cat: string, sub_cat: string, major_cat: string, channel: string, period: timestamp, desc: string, sample_size: bigint, item_asp: double, total_spend: double, total_q: double, gmv: double, unit_volume: double, fpe_total_spend: double, fpe_total_q: double, total_fpe: double]
[2025-09-15 19:38:23] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_grouping' ..
[2025-09-15 19:38:47] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2670593s to 2674528s.
[2025-09-15 19:38:47] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674528, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:38:47] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_grouping have changed. Updating retention settings...
[2025-09-15 19:38:47] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_grouping' table properties `delta.deletedFileRetentionDuration` to 'interval 2674528 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:38:53] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_grouping!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_grouping"
With Dataframe:
DataFrame[product_hash: string, merchant: string, brand: string, minor_cat: string, sub_cat: string, major_cat: string, channel: string, period: timestamp, desc: string, sample_size: bigint, item_asp: double, total_spend: double, total_q: double, gmv: double, unit_volume: double, fpe_total_spend: double, fpe_total_q: double, total_fpe: double]
[2025-09-15 19:39:04] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_grouping' ..
[2025-09-15 19:39:26] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2670485s to 2674535s.
[2025-09-15 19:39:26] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674535, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:39:26] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_grouping have changed. Updating retention settings...
[2025-09-15 19:39:26] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_grouping' table properties `delta.deletedFileRetentionDuration` to 'interval 2674535 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:39:31] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_grouping!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_grouping"
With Dataframe:
DataFrame[product_hash: string, pct_included: double, is_stable: boolean, min_period: timestamp, max_period: timestamp]
[2025-09-15 19:39:39] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_stable_products_list' ..
[2025-09-15 19:39:45] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2670409s to 2674534s.
[2025-09-15 19:39:45] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674534, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:39:45] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_stable_products_list have changed. Updating retention settings...
[2025-09-15 19:39:45] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_stable_products_list' table properties `delta.deletedFileRetentionDuration` to 'interval 2674534 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:39:50] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_stable_products_list!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_stable_products_list"
With Dataframe:
DataFrame[product_hash: string, pct_included: double, is_stable: boolean, min_period: timestamp, max_period: timestamp]
[2025-09-15 19:39:58] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_stable_products_list' ..
[2025-09-15 19:40:07] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2670370s to 2674535s.
[2025-09-15 19:40:07] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674535, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:40:07] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_stable_products_list have changed. Updating retention settings...
[2025-09-15 19:40:07] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_stable_products_list' table properties `delta.deletedFileRetentionDuration` to 'interval 2674535 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:40:12] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_stable_products_list!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_stable_products_list"
With Dataframe:
DataFrame[period: timestamp, product_hash: string, filled_item_asp: double, filled_sample_size: bigint, filled_total_spend: double, filled_total_q: double, filled_gmv: double]
[2025-09-15 19:40:20] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_product_filled_prices' ..
[2025-09-15 19:40:38] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2670322s to 2674537s.
[2025-09-15 19:40:38] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674537, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:40:38] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_product_filled_prices have changed. Updating retention settings...
[2025-09-15 19:40:38] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_product_filled_prices' table properties `delta.deletedFileRetentionDuration` to 'interval 2674537 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:40:44] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_product_filled_prices!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_week_product_filled_prices"
With Dataframe:
DataFrame[period: timestamp, product_hash: string, filled_item_asp: double, filled_sample_size: bigint, filled_total_spend: double, filled_total_q: double, filled_gmv: double]
[2025-09-15 19:40:51] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_product_filled_prices' ..
[2025-09-15 19:41:05] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2670285s to 2674539s.
[2025-09-15 19:41:05] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674539, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:41:05] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_product_filled_prices have changed. Updating retention settings...
[2025-09-15 19:41:05] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_product_filled_prices' table properties `delta.deletedFileRetentionDuration` to 'interval 2674539 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:41:13] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_product_filled_prices!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_tariffs_month_product_filled_prices"
Succesfully exported Tariffs module.


run_export_retailer_leakage_module
With Dataframe:
DataFrame[user_id: string, source: string, merchant: string, first_active_quarter: timestamp, brand: string, quarter: timestamp, major_cat: string, sub_cat: string, minor_cat: string, item_subtotal: double, total_panelists: bigint, total_panelists_channel: bigint]
[2025-09-15 19:41:24] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_leakage_users' ..
[2025-09-15 19:42:08] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2670110s to 2674540s.
[2025-09-15 19:42:08] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674540, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:42:08] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_leakage_users have changed. Updating retention settings...
[2025-09-15 19:42:08] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_leakage_users' table properties `delta.deletedFileRetentionDuration` to 'interval 2674540 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:42:17] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_leakage_users!
UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_leakage_users"
With Dataframe:
DataFrame[key_retailer: string, source: string, merchant: string, brand: string, quarter: timestamp, major_cat: string, sub_cat: string, minor_cat: string, closer_flag: string, item_subtotal: double, total_panelists: bigint]
[2025-09-15 19:42:36] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_leakage_retailer' ..
[2025-09-15 19:45:10] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2669880s to 2674568s.
[2025-09-15 19:45:10] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674568, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:45:10] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_leakage_retailer have changed. Updating retention settings...
[2025-09-15 19:45:10] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_leakage_retailer' table properties `delta.deletedFileRetentionDuration` to 'interval 2674568 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
An error occurred (InvalidParameter) when calling the Publish operation: Invalid parameter: Message too long
[2025-09-15 19:45:17] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_leakage_retailer!

UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_leakage_retailer"
With Dataframe:
DataFrame[merchant: string, source: string, quarter: timestamp, major_cat: string, sub_cat: string, minor_cat: string, user_id: string, qtrly_omni_panelists: bigint, qtrly_channel_panelists: bigint]
[2025-09-15 19:45:27] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_category_closure' ..
[2025-09-15 19:46:18] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1058] Need to update table file retention from 2669738s to 2674579s.
[2025-09-15 19:46:18] INFO [yipit_databricks_utils._get_final_table_retention_in_seconds:1069] Using retention parameters: file_retention_seconds=2674579, log_retention_days=3650, minimum_versions=1
[2025-09-15 19:46:18] INFO [yipit_databricks_utils.calculate_and_update_table_retention_if_needed:904] WARNING: The retention settings for yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_category_closure have changed. Updating retention settings...
[2025-09-15 19:46:18] INFO [yipit_databricks_utils._update_table_retention:1507] UC operation: Setting 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_category_closure' table properties `delta.deletedFileRetentionDuration` to 'interval 2674579 seconds' and `delta.logRetentionDuration` to 'interval 87600 hours' ...
[2025-09-15 19:46:26] INFO [yipit_databricks_utils.create_table:1862] Created yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_category_closure!

UC operation: Vacuuming "yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_category_closure"
With Dataframe:
DataFrame[key_retailer: string, retailer: string, source: string, brand: string, quarter: timestamp, major_cat: string, sub_cat: string, minor_cat: string, product: string, item_gmv: double, sample_size: bigint, asp: double]
[2025-09-15 19:46:48] INFO [yipit_databricks_utils.create_table:1780] UC operation: Creating 'yd_sensitive_corporate.ydx_prospect_analysts_gold.beauty_product_v38_leakage_product' ..
{"ts": "2025-09-15 19:56:59,899", "level": "ERROR", "logger": "pyspark.sql.connect.client.logging", "msg": "GRPC Error received", "context": {}, "exception": {"class": "_MultiThreadedRendezvous", "msg": "<_MultiThreadedRendezvous of RPC that terminated with:\n\tstatus = StatusCode.INTERNAL\n\tdetails = \"[QUERY_EXECUTION_TIMEOUT_EXCEEDED] Query execution was cancelled due to exceeding the timeout (600s). You can increase the limit in seconds by setting spark.databricks.execution.timeout. SQLSTATE: 57KD0\"\n\tdebug_error_string = \"UNKNOWN:Error received from peer  {created_time:\"2025-09-15T19:56:59.898714987+00:00\", grpc_status:13, grpc_message:\"[QUERY_EXECUTION_TIMEOUT_EXCEEDED] Query execution was cancelled due to exceeding the timeout (600s). You can increase the limit in seconds by setting spark.databricks.execution.timeout. SQLSTATE: 57KD0\"}\"\n>", "stacktrace": ["Traceback (most recent call last):", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/core.py\", line 1902, in _execute_and_fetch_as_iterator", "    for b in generator:", "  File \"<frozen _collections_abc>\", line 356, in __next__", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 141, in send", "    if not self._has_next():", "           ^^^^^^^^^^^^^^^^", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 202, in _has_next", "    raise e", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 174, in _has_next", "    self._current = self._call_iter(", "                    ^^^^^^^^^^^^^^^^", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 299, in _call_iter", "    raise e", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 279, in _call_iter", "    return iter_fun()", "           ^^^^^^^^^^", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 175, in <lambda>", "    lambda: next(self._iterator)  # type: ignore[arg-type]", "            ^^^^^^^^^^^^^^^^^^^^", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/core.py\", line 650, in __iter__", "    for response in self._call:", "  File \"/databricks/python/lib/python3.12/site-packages/grpc/_channel.py\", line 543, in __next__", "    return self._next()", "           ^^^^^^^^^^^^", "  File \"/databricks/python/lib/python3.12/site-packages/grpc/_channel.py\", line 969, in _next", "    raise self", "grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:", "\tstatus = StatusCode.INTERNAL", "\tdetails = \"[QUERY_EXECUTION_TIMEOUT_EXCEEDED] Query execution was cancelled due to exceeding the timeout (600s). You can increase the limit in seconds by setting spark.databricks.execution.timeout. SQLSTATE: 57KD0\"", "\tdebug_error_string = \"UNKNOWN:Error received from peer  {created_time:\"2025-09-15T19:56:59.898714987+00:00\", grpc_status:13, grpc_message:\"[QUERY_EXECUTION_TIMEOUT_EXCEEDED] Query execution was cancelled due to exceeding the timeout (600s). You can increase the limit in seconds by setting spark.databricks.execution.timeout. SQLSTATE: 57KD0\"}\"", ">"]}}
{"ts": "2025-09-15 19:56:59,899", "level": "ERROR", "logger": "pyspark.sql.connect.client.logging", "msg": "GRPC Error received", "context": {}, "exception": {"class": "_MultiThreadedRendezvous", "msg": "<_MultiThreadedRendezvous of RPC that terminated with:\n\tstatus = StatusCode.INTERNAL\n\tdetails = \"[QUERY_EXECUTION_TIMEOUT_EXCEEDED] Query execution was cancelled due to exceeding the timeout (600s). You can increase the limit in seconds by setting spark.databricks.execution.timeout. SQLSTATE: 57KD0\"\n\tdebug_error_string = \"UNKNOWN:Error received from peer  {created_time:\"2025-09-15T19:56:59.898714987+00:00\", grpc_status:13, grpc_message:\"[QUERY_EXECUTION_TIMEOUT_EXCEEDED] Query execution was cancelled due to exceeding the timeout (600s). You can increase the limit in seconds by setting spark.databricks.execution.timeout. SQLSTATE: 57KD0\"}\"\n>", "stacktrace": ["Traceback (most recent call last):", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/core.py\", line 1902, in _execute_and_fetch_as_iterator", "    for b in generator:", "  File \"<frozen _collections_abc>\", line 356, in __next__", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 141, in send", "    if not self._has_next():", "           ^^^^^^^^^^^^^^^^", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 202, in _has_next", "    raise e", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 174, in _has_next", "    self._current = self._call_iter(", "                    ^^^^^^^^^^^^^^^^", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 299, in _call_iter", "    raise e", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 279, in _call_iter", "    return iter_fun()", "           ^^^^^^^^^^", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 175, in <lambda>", "    lambda: next(self._iterator)  # type: ignore[arg-type]", "            ^^^^^^^^^^^^^^^^^^^^", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/core.py\", line 650, in __iter__", "    for response in self._call:", "  File \"/databricks/python/lib/python3.12/site-packages/grpc/_channel.py\", line 543, in __next__", "    return self._next()", "           ^^^^^^^^^^^^", "  File \"/databricks/python/lib/python3.12/site-packages/grpc/_channel.py\", line 969, in _next", "    raise self", "grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:", "\tstatus = StatusCode.INTERNAL", "\tdetails = \"[QUERY_EXECUTION_TIMEOUT_EXCEEDED] Query execution was cancelled due to exceeding the timeout (600s). You can increase the limit in seconds by setting spark.databricks.execution.timeout. SQLSTATE: 57KD0\"", "\tdebug_error_string = \"UNKNOWN:Error received from peer  {created_time:\"2025-09-15T19:56:59.898714987+00:00\", grpc_status:13, grpc_message:\"[QUERY_EXECUTION_TIMEOUT_EXCEEDED] Query execution was cancelled due to exceeding the timeout (600s). You can increase the limit in seconds by setting spark.databricks.execution.timeout. SQLSTATE: 57KD0\"}\"", ">"]}}
{"ts": "2025-09-15 19:56:59,899", "level": "ERROR", "logger": "pyspark.sql.connect.client.logging", "msg": "GRPC Error received", "context": {}, "exception": {"class": "_MultiThreadedRendezvous", "msg": "<_MultiThreadedRendezvous of RPC that terminated with:\n\tstatus = StatusCode.INTERNAL\n\tdetails = \"[QUERY_EXECUTION_TIMEOUT_EXCEEDED] Query execution was cancelled due to exceeding the timeout (600s). You can increase the limit in seconds by setting spark.databricks.execution.timeout. SQLSTATE: 57KD0\"\n\tdebug_error_string = \"UNKNOWN:Error received from peer  {created_time:\"2025-09-15T19:56:59.898714987+00:00\", grpc_status:13, grpc_message:\"[QUERY_EXECUTION_TIMEOUT_EXCEEDED] Query execution was cancelled due to exceeding the timeout (600s). You can increase the limit in seconds by setting spark.databricks.execution.timeout. SQLSTATE: 57KD0\"}\"\n>", "stacktrace": ["Traceback (most recent call last):", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/core.py\", line 1902, in _execute_and_fetch_as_iterator", "    for b in generator:", "  File \"<frozen _collections_abc>\", line 356, in __next__", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 141, in send", "    if not self._has_next():", "           ^^^^^^^^^^^^^^^^", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 202, in _has_next", "    raise e", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 174, in _has_next", "    self._current = self._call_iter(", "                    ^^^^^^^^^^^^^^^^", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 299, in _call_iter", "    raise e", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 279, in _call_iter", "    return iter_fun()", "           ^^^^^^^^^^", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/reattach.py\", line 175, in <lambda>", "    lambda: next(self._iterator)  # type: ignore[arg-type]", "            ^^^^^^^^^^^^^^^^^^^^", "  File \"/local_disk0/.ephemeral_nfs/envs/pythonEnv-a7a8ceaf-ae30-4641-8c84-9fe34bbec6d9/lib/python3.12/site-packages/pyspark/sql/connect/client/core.py\", line 650, in __iter__", "    for response in self._call:", "  File \"/databricks/python/lib/python3.12/site-packages/grpc/_channel.py\", line 543, in __next__", "    return self._next()", "           ^^^^^^^^^^^^", "  File \"/databricks/python/lib/python3.12/site-packages/grpc/_channel.py\", line 969, in _next", "    raise self", "grpc._channel._MultiThreadedRendezvous: <_MultiThreadedRendezvous of RPC that terminated with:", "\tstatus = StatusCode.INTERNAL", "\tdetails = \"[QUERY_EXECUTION_TIMEOUT_EXCEEDED] Query execution was cancelled due to exceeding the timeout (600s). You can increase the limit in seconds by setting spark.databricks.execution.timeout. SQLSTATE: 57KD0\"", "\tdebug_error_string = \"UNKNOWN:Error received from peer  {created_time:\"2025-09-15T19:56:59.898714987+00:00\", grpc_status:13, grpc_message:\"[QUERY_EXECUTION_TIMEOUT_EXCEEDED] Query execution was cancelled due to exceeding the timeout (600s). You can increase the limit in seconds by setting spark.databricks.execution.timeout. SQLSTATE: 57KD0\"}\"", ">"]}}